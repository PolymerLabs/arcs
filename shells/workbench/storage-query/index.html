<!doctype html>

<script type="module">
  import '../../lib/firebase-support.js';
  import {Utils} from '../../lib/utils.js';
  import {Stores} from '../../lib/stores.js';
  import {SyntheticStores} from '../../lib/synthetic-stores.js';
  import {Const} from '../../configuration/constants.js';

  // observable specifier:
  //  handle {type, storageKey}

  const observe = async (storage, id, onchange) => {
    const store = await SyntheticStores.getStore(Const.defaultFirebaseStorageKey, 'user-launcher');
    console.log(store);
    const data = await store.toList();
    console.log(data);
    store.on('change', onchange, observe);
    const dispose = () => store.off(onchange);
    const observer = {store, data, dispose};
  };

  (async () => {
    const observer = observe(Const.defaultFirebaseStorageKey, 'user-launcher', change => console.log(change));
  })();
</script>
