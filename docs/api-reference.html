---
layout: default
title: API Reference
---
<api-doc></api-doc>

<script>
  class Semver {
    constructor(str) {
      this.v = Semver.parse(str);
    }
    static parse(s) {
      const re = /^v(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)$/;
      const v = s.match(re);
      if (!v || v.length != 4) {
        return null;
      }
      return v.slice(1).map(n => { return parseInt(n, 10); });
    }
    static compare(a, b) {    
      if (a.v[0] == b.v[0]) {
        if (a.v[1] == b.v[1]) {
          return a.v[2] - b.v[2];
        }
        return a.v[1] - b.v[1];
      }
      return a.v[0] - b.v[0];
    }

    get valid() {
      return this.v;
    }
  }
  
  const url = "https://api.github.com/repos/PolymerLabs/arcs-cdn/contents?access_token=0899ff5a191a7e306508f53ee729cb6487840618";

  fetch(url).then(function(response) {
    return response.json();
  }).then(function(response) {
    let html = [];
    versions = response.map(
      e => { return { name: e.name, version: new Semver(e.name) }; }
    ).filter(
      e => { return e.version.valid; }
    );
    versions.sort(function (a, b) { return Semver.compare(a.version, b.version); });
    versions.reverse();

    versions.map(e => {
      html.push(`<a href="https://polymerlabs.github.io/arcs-cdn/${e.name}/index.html" target="_blank">${e.name}</a><br>`);
    });
    html.push(`<iframe width='100%' height='600px' src="https://polymerlabs.github.io/arcs-cdn/${versions[0].name}/index.html"></iframe>`);
    document.querySelector('api-doc').innerHTML = html.join(' ');

  });
</script>
